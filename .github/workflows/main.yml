# .github/workflows/main.yml

name: Fikir-motoru CI/CD

# main dalına push veya pull request geldiğinde tetiklenir
on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build-and-test:
    # En güncel Ubuntu sürümünde çalıştır
    runs-on: ubuntu-latest

    strategy:
      matrix:
        # Projenizin desteklediği Node.js sürümleriyle test edin
        node-version: [18.x, 20.x]

    steps:
      # 1. Adım: Kodu (repository) sanal makineye indirir
      - name: Kodu al (Checkout)
        uses: actions/checkout@v4

      # 2. Adım: Node.js'i kurar
      - name: Node.js ${{ matrix.node-version }} sürümünü kur
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          # Burası hatayı aldığınız yer. 
          # package-lock.json dosyasını eklediğinizde burası düzelecektir.
          cache: 'npm'

      # 3. Adım: Bağımlılıkları yükle (Hızlı ve tutarlı 'ci' komutu ile)
      # 'npm install' YERİNE 'npm ci' KULLANIN
      - name: Bağımlılıkları yükle
        run: npm ci

      # 4. Adım: Build script'i varsa çalıştır (örn: React, Vue, TS projeleri için)
      - name: Projeyi derle (Build)
        run: npm run build --if-present

      # 5. Adım: Testleri çalıştır
      - name: Testleri çalıştır
        run: npm test
